Loading and Processing Data...
Data MIMIC successfully loaded for features ['DBP', 'ESI', 'HR', 'RR', 'SBP', 'SPO2', 'TEMP', 'age', 'gender'] and outcomes ['Death', 'Discharge', 'ICU', 'Ward'].
(X, y) shape: (8328, 10, 9), (8328, 4)
Outcome Distribution: Death          26
Discharge    2860
ICU          1321
Ward         4121
dtype: int64
Loading and Training Model for fold 1...
 Logging experiments in exps/DirVRNN/Run_29_2023-08-02_17-51-17/fold_1
ELBO:  tensor([-97.4858], grad_fn=<AddBackward0>)
batch_loss tensor([97.4858], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.4858], grad_fn=<MulBackward0>)
batch loss item 97.48580932617188
tr_loss before tensor([0.]).0]
tr_loss tensor([97.4858])
ELBO:  tensor([-97.4007], grad_fn=<AddBackward0>)
batch_loss tensor([97.4007], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.4007], grad_fn=<MulBackward0>)
batch loss item 97.40070343017578
tr_loss before tensor([97.4858])
tr_loss tensor([194.8865])
ELBO:  tensor([-97.5959], grad_fn=<AddBackward0>)
batch_loss tensor([97.5959], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.5959], grad_fn=<MulBackward0>)
batch loss item 97.59586334228516
tr_loss before tensor([194.8865])
tr_loss tensor([292.4824])
ELBO:  tensor([-97.3056], grad_fn=<AddBackward0>)
batch_loss tensor([97.3056], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.3056], grad_fn=<MulBackward0>)
batch loss item 97.3056411743164
tr_loss before tensor([292.4824])
tr_loss tensor([389.7880])
ELBO:  tensor([-97.6472], grad_fn=<AddBackward0>)
batch_loss tensor([97.6472], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.6472], grad_fn=<MulBackward0>)
batch loss item 97.64717102050781
tr_loss before tensor([389.7880])
tr_loss tensor([487.4352])
ELBO:  tensor([-97.3789], grad_fn=<AddBackward0>)
batch_loss tensor([97.3789], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.3789], grad_fn=<MulBackward0>)
batch loss item 97.37886810302734
tr_loss before tensor([487.4352])
tr_loss tensor([584.8140])
ELBO:  tensor([-97.2844], grad_fn=<AddBackward0>)
batch_loss tensor([97.2844], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.2844], grad_fn=<MulBackward0>)
batch loss item 97.28443908691406
tr_loss before tensor([584.8140])
tr_loss tensor([682.0984])
ELBO:  tensor([-97.2354], grad_fn=<AddBackward0>)
batch_loss tensor([97.2354], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.2354], grad_fn=<MulBackward0>)
batch loss item 97.23542022705078
tr_loss before tensor([682.0984])
tr_loss tensor([779.3339])
ELBO:  tensor([-97.2473], grad_fn=<AddBackward0>)
batch_loss tensor([97.2473], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.2473], grad_fn=<MulBackward0>)
batch loss item 97.24730682373047
tr_loss before tensor([779.3339])
tr_loss tensor([876.5812])
ELBO:  tensor([-97.6296], grad_fn=<AddBackward0>)
batch_loss tensor([97.6296], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.6296], grad_fn=<MulBackward0>)
batch loss item 97.62960815429688
tr_loss before tensor([876.5812])
tr_loss tensor([974.2108])
ELBO:  tensor([-97.3455], grad_fn=<AddBackward0>)
batch_loss tensor([97.3455], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.3455], grad_fn=<MulBackward0>)
batch loss item 97.3454818725586
tr_loss before tensor([974.2108])
tr_loss tensor([1071.5563])
ELBO:  tensor([-97.4163], grad_fn=<AddBackward0>)
batch_loss tensor([97.4163], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.4163], grad_fn=<MulBackward0>)
batch loss item 97.41632080078125
tr_loss before tensor([1071.5563])
tr_loss tensor([1168.9727])
ELBO:  tensor([-97.3857], grad_fn=<AddBackward0>)
batch_loss tensor([97.3857], grad_fn=<MulBackward0>)
Traceback (most recent call last):
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 125, in <module>
    main()
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 99, in main
    model.fit(train_data=(X_train, y_train), val_data=(X_val, y_val),
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/DirVRNN.py", line 553, in fit
    "Train {} ({:.0f}%):  [loss {:.2f} - loglik {:.2f} - kl {:.2f} - outl {:.2f}]".format(
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/site-packages/torch/_tensor.py", line 873, in __format__
    return object.__format__(self, format_spec)
TypeError: unsupported format string passed to Tensor.__format__
batch loss after backward tensor([97.3857], grad_fn=<MulBackward0>)
batch loss item 97.38568878173828
tr_loss before tensor([1168.9727])
tr_loss tensor([1266.3584])
ELBO:  tensor([-97.4420], grad_fn=<AddBackward0>)
batch_loss tensor([97.4420], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.4420], grad_fn=<MulBackward0>)
batch loss item 97.44196319580078
tr_loss before tensor([1266.3584])
tr_loss tensor([1363.8004])
ELBO:  tensor([-97.2822], grad_fn=<AddBackward0>)
batch_loss tensor([97.2822], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.2822], grad_fn=<MulBackward0>)
batch loss item 97.28215026855469
tr_loss before tensor([1363.8004])
tr_loss tensor([1461.0825])
ELBO:  tensor([-97.6794], grad_fn=<AddBackward0>)
batch_loss tensor([97.6794], grad_fn=<MulBackward0>)
batch loss after backward tensor([97.6794], grad_fn=<MulBackward0>)
batch loss item 97.67936706542969
tr_loss before tensor([1461.0825])
tr_loss tensor([1558.7618])
epoch loss:  tensor([97.4226])
epoch loglik:  tensor([-95.8436])
epoch kl:  tensor([2.9981])
epoch outl:  tensor([1.4191])
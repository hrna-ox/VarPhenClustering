Loading and Processing Data...
Data MIMIC successfully loaded for features ['DBP', 'ESI', 'HR', 'RR', 'SBP', 'SPO2', 'TEMP', 'age', 'gender'] and outcomes ['Death', 'Discharge', 'ICU', 'Ward'].
(X, y) shape: (8328, 10, 9), (8328, 4)
Outcome Distribution: Death          26
Discharge    2860
ICU          1321
Ward         4121
dtype: int64
Loading and Training Model for fold 1...
 Logging experiments in exps/DirVRNN/Run_30_2023-08-02_17-52-14/fold_1
batch_loss tensor([99.0118], grad_fn=<MulBackward0>)
batch loss after backward tensor([99.0118], grad_fn=<MulBackward0>)
batch loss item 99.01182556152344
tr_loss before tensor([0.]).0]
tr_loss tensor([99.0118])
batch_loss tensor([99.0083], grad_fn=<MulBackward0>)
batch loss after backward tensor([99.0083], grad_fn=<MulBackward0>)
batch loss item 99.0083236694336
tr_loss before tensor([99.0118])
tr_loss tensor([198.0201])
batch_loss tensor([99.0811], grad_fn=<MulBackward0>)
batch loss after backward tensor([99.0811], grad_fn=<MulBackward0>)
batch loss item 99.08106231689453
tr_loss before tensor([198.0201])
tr_loss tensor([297.1012])
batch_loss tensor([98.7875], grad_fn=<MulBackward0>)
batch loss after backward tensor([98.7875], grad_fn=<MulBackward0>)
batch loss item 98.78752899169922
tr_loss before tensor([297.1012])
tr_loss tensor([395.8887])
batch_loss tensor([99.0621], grad_fn=<MulBackward0>)
batch loss after backward tensor([99.0621], grad_fn=<MulBackward0>)
batch loss item 99.06206512451172
tr_loss before tensor([395.8887])
tr_loss tensor([494.9508])
batch_loss tensor([98.6428], grad_fn=<MulBackward0>)
batch loss after backward tensor([98.6428], grad_fn=<MulBackward0>)
batch loss item 98.64275360107422
tr_loss before tensor([494.9508])
tr_loss tensor([593.5936])
batch_loss tensor([98.9075], grad_fn=<MulBackward0>)
batch loss after backward tensor([98.9075], grad_fn=<MulBackward0>)
batch loss item 98.90750885009766
tr_loss before tensor([593.5936])
tr_loss tensor([692.5011])
batch_loss tensor([98.8998], grad_fn=<MulBackward0>)
batch loss after backward tensor([98.8998], grad_fn=<MulBackward0>)
batch loss item 98.89978790283203
tr_loss before tensor([692.5011])
tr_loss tensor([791.4009])
batch_loss tensor([98.8162], grad_fn=<MulBackward0>)
batch loss after backward tensor([98.8162], grad_fn=<MulBackward0>)
batch loss item 98.816162109375
tr_loss before tensor([791.4009])
tr_loss tensor([890.2170])
batch_loss tensor([98.8278], grad_fn=<MulBackward0>)
batch loss after backward tensor([98.8278], grad_fn=<MulBackward0>)
batch loss item 98.82781982421875
tr_loss before tensor([890.2170])
tr_loss tensor([989.0449])
batch_loss tensor([98.6645], grad_fn=<MulBackward0>)
batch loss after backward tensor([98.6645], grad_fn=<MulBackward0>)
batch loss item 98.66445922851562
tr_loss before tensor([989.0449])
tr_loss tensor([1087.7094])
batch_loss tensor([98.7684], grad_fn=<MulBackward0>)
batch loss after backward tensor([98.7684], grad_fn=<MulBackward0>)
batch loss item 98.76841735839844
tr_loss before tensor([1087.7094])
tr_loss tensor([1186.4778])
batch_loss tensor([99.1069], grad_fn=<MulBackward0>)
batch loss after backward tensor([99.1069], grad_fn=<MulBackward0>)
batch loss item 99.10685729980469
tr_loss before tensor([1186.4778])
tr_loss tensor([1285.5846])
batch_loss tensor([99.2599], grad_fn=<MulBackward0>)
Traceback (most recent call last):
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 125, in <module>
    main()
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 99, in main
    model.fit(train_data=(X_train, y_train), val_data=(X_val, y_val),
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/DirVRNN.py", line 551, in fit
    "Train {} ({:.0f}%):  [loss {:.2f} - loglik {:.2f} - kl {:.2f} - outl {:.2f}]".format(
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/site-packages/torch/_tensor.py", line 873, in __format__
    return object.__format__(self, format_spec)
TypeError: unsupported format string passed to Tensor.__format__
batch loss after backward tensor([99.2599], grad_fn=<MulBackward0>)
batch loss item 99.25985717773438
tr_loss before tensor([1285.5846])
tr_loss tensor([1384.8445])
batch_loss tensor([98.8458], grad_fn=<MulBackward0>)
batch loss after backward tensor([98.8458], grad_fn=<MulBackward0>)
batch loss item 98.8458480834961
tr_loss before tensor([1384.8445])
tr_loss tensor([1483.6903])
batch_loss tensor([98.1180], grad_fn=<MulBackward0>)
batch loss after backward tensor([98.1180], grad_fn=<MulBackward0>)
batch loss item 98.11795043945312
tr_loss before tensor([1483.6903])
tr_loss tensor([1581.8082])
Loading and Processing Data...
Data MIMIC successfully loaded for features ['DBP', 'ESI', 'HR', 'RR', 'SBP', 'SPO2', 'TEMP', 'age', 'gender'] and outcomes ['Death', 'Discharge', 'ICU', 'Ward'].
(X, y) shape: (8328, 10, 9), (8328, 4)
Outcome Distribution: Death          26
Discharge    2860
ICU          1321
Ward         4121
dtype: int64
Loading and Training Model for fold 1...
 Logging experiments in exps/DirVRNN/Run_34_2023-08-02_18-02-30/fold_1
batch_loss tensor([95.2478], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.2478], grad_fn=<MulBackward0>)
batch loss item 95.247802734375
tr_loss before tensor([0.]).0]
tr_loss tensor([95.2478])
batch_loss tensor([95.0826], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.0826], grad_fn=<MulBackward0>)
batch loss item 95.08256530761719
tr_loss before tensor([95.2478])
tr_loss tensor([190.3304])
batch_loss tensor([95.0127], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.0127], grad_fn=<MulBackward0>)
batch loss item 95.01271057128906
tr_loss before tensor([190.3304])
tr_loss tensor([285.3431])
batch_loss tensor([95.2242], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.2242], grad_fn=<MulBackward0>)
batch loss item 95.22415924072266
tr_loss before tensor([285.3431])
tr_loss tensor([380.5672])
batch_loss tensor([95.0343], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.0343], grad_fn=<MulBackward0>)
batch loss item 95.0343017578125
tr_loss before tensor([380.5672])
tr_loss tensor([475.6015])
batch_loss tensor([95.0767], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.0767], grad_fn=<MulBackward0>)
batch loss item 95.07672119140625
tr_loss before tensor([475.6015])
tr_loss tensor([570.6782])
batch_loss tensor([95.0808], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.0808], grad_fn=<MulBackward0>)
batch loss item 95.08082580566406
tr_loss before tensor([570.6782])
tr_loss tensor([665.7590])
batch_loss tensor([95.6357], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.6357], grad_fn=<MulBackward0>)
batch loss item 95.63574981689453
tr_loss before tensor([665.7590])
tr_loss tensor([761.3948])
batch_loss tensor([95.3239], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.3239], grad_fn=<MulBackward0>)
batch loss item 95.32392120361328
tr_loss before tensor([761.3948])
tr_loss tensor([856.7187])
batch_loss tensor([95.1104], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.1104], grad_fn=<MulBackward0>)
batch loss item 95.11038208007812
tr_loss before tensor([856.7187])
tr_loss tensor([951.8291])
batch_loss tensor([95.1379], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.1379], grad_fn=<MulBackward0>)
batch loss item 95.1379165649414
tr_loss before tensor([951.8291])
tr_loss tensor([1046.9670])
batch_loss tensor([95.3680], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.3680], grad_fn=<MulBackward0>)
batch loss item 95.36799621582031
tr_loss before tensor([1046.9670])
tr_loss tensor([1142.3351])
batch_loss tensor([95.5306], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.5306], grad_fn=<MulBackward0>)
batch loss item 95.53060913085938
tr_loss before tensor([1142.3351])
tr_loss tensor([1237.8657])
batch_loss tensor([95.1534], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.1534], grad_fn=<MulBackward0>)
batch loss item 95.15341186523438
tr_loss before tensor([1237.8657])
tr_loss tensor([1333.0192])
batch_loss tensor([95.3298], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.3298], grad_fn=<MulBackward0>)
batch loss item 95.329833984375
tr_loss before tensor([1333.0192])
tr_loss tensor([1428.3490])
batch_loss tensor([95.5437], grad_fn=<MulBackward0>)
batch loss after backward tensor([95.5437], grad_fn=<MulBackward0>)
batch loss item 95.5436782836914
tr_loss before tensor([1428.3490])
tr_loss tensor([1523.8927])
Epoch Losses
tensor([95.2433])
tensor([-96.9351])
tensor([-0.3328])
tensor([1.3590])
Train 1 (100%):  [loss tensor([95.2433]) - loglik tensor([-96.9351]) - kl tensor([-0.3328]) - outl tensor([1.3590])]
Traceback (most recent call last):
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 125, in <module>
    main()
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 99, in main
    model.fit(train_data=(X_train, y_train), val_data=(X_val, y_val),
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/DirVRNN.py", line 599, in fit
    history_sup_scores_lachiche_algo = metrics.get_multiclass_sup_scores(y_true=y, y_pred=y_pred, run_weight_algo=True)
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/metrics.py", line 515, in get_multiclass_sup_scores
    roc_auc = auroc(y_true_npy, y_pred_npy)
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/metrics.py", line 409, in auroc
    ovr_roc_scores = metrics.roc_auc_score(labels_true, y_score=y_pred, average="macro",
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 211, in wrapper
    return func(*args, **kwargs)
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 620, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 693, in _multiclass_roc_auc_score
    raise ValueError(
Class sizes:  [  4. 344. 158. 494.]433]) - loglik tensor([-96.9351]) - kl tensor([-0.3328]) - outl tensor([1.3590])]     Val 1 (100%):  [loss 95.42 - loglik -97.16 - kl -0.35 - outl 1.39]     Weights computed:  [0.93364381 0.76553087 0.56591165 1.        ]
Class sizes:  [  4. 344. 158. 494.]433]) - loglik tensor([-96.9351]) - kl tensor([-0.3328]) - outl tensor([1.3590])]     Val 1 (100%):  [loss 95.42 - loglik -97.16 - kl -0.35 - outl 1.39]     Weights computed:  [0.93364381 0.76553087 0.56591165 1.        ]
Ordered classes:  [3 1 2 0]
Weights ordered:  [1.         0.76553087 0.56591165 0.93364381]
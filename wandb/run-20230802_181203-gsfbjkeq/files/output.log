Loading and Processing Data...
Data MIMIC successfully loaded for features ['DBP', 'ESI', 'HR', 'RR', 'SBP', 'SPO2', 'TEMP', 'age', 'gender'] and outcomes ['Death', 'Discharge', 'ICU', 'Ward'].
(X, y) shape: (8328, 10, 9), (8328, 4)
Outcome Distribution: Death          26
Discharge    2860
ICU          1321
Ward         4121
dtype: int64
Loading and Training Model for fold 1...
 Logging experiments in exps/DirVRNN/Run_39_2023-08-02_18-12-08/fold_1
Printing Losses loss, Log Lik, KL, Outl
Epoch 1 :  100.00 - 96.04 - -95.89 - 1.42]     Val 1 (100%): 96.66 - -96.47 - 1.44 - 1.25]
Traceback (most recent call last):
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 125, in <module>
    main()
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 99, in main
    model.fit(train_data=(X_train, y_train), val_data=(X_val, y_val),
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/DirVRNN.py", line 597, in fit
    history_sup_scores_lachiche_algo = metrics.get_multiclass_sup_scores(y_true=y, y_pred=y_pred, run_weight_algo=True)
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/metrics.py", line 515, in get_multiclass_sup_scores
    roc_auc = auroc(y_true_npy, y_pred_npy)
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/metrics.py", line 409, in auroc
    ovr_roc_scores = metrics.roc_auc_score(labels_true, y_score=y_pred, average="macro",
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 211, in wrapper
    return func(*args, **kwargs)
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 620, in roc_auc_score
    return _multiclass_roc_auc_score(
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 693, in _multiclass_roc_auc_score
    raise ValueError(
ValueError: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
Weights computed:  [1.59208913 0.06308261 0.08848634 1.        ]
Class sizes:  [  4. 344. 158. 494.]
Ordered classes:  [3 1 2 0]
Weights ordered:  [1.         0.06308261 0.08848634 1.59208913]
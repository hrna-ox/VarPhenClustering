Loading and Processing Data...
Data MIMIC successfully loaded for features ['DBP', 'ESI', 'HR', 'RR', 'SBP', 'SPO2', 'TEMP', 'age', 'gender'] and outcomes ['Death', 'Discharge', 'ICU', 'Ward'].
(X, y) shape: (8328, 10, 9), (8328, 4)
Outcome Distribution: Death          26
Discharge    2860
ICU          1321
Ward         4121
dtype: int64
Loading and Training Model for fold 1...
 Logging experiments in exps/DirVRNN/Run_25_2023-08-02_17-44-09/fold_1
ELBO:  tensor([-100.8619], grad_fn=<AddBackward0>)
batch_loss tensor([100.8619], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.8619], grad_fn=<MulBackward0>)
tr_loss tensor([100.8619]) 0.0]
ELBO:  tensor([-101.0280], grad_fn=<AddBackward0>)
batch_loss tensor([101.0280], grad_fn=<MulBackward0>)
batch loss after backward tensor([101.0280], grad_fn=<MulBackward0>)
tr_loss tensor([201.8899]) 6.25]
ELBO:  tensor([-100.7343], grad_fn=<AddBackward0>)
batch_loss tensor([100.7343], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.7343], grad_fn=<MulBackward0>)
tr_loss tensor([302.6243]) 12.5]
ELBO:  tensor([-100.2100], grad_fn=<AddBackward0>)
batch_loss tensor([100.2100], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.2100], grad_fn=<MulBackward0>)
tr_loss tensor([402.8343]) 18.75]
ELBO:  tensor([-100.6454], grad_fn=<AddBackward0>)
batch_loss tensor([100.6454], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.6454], grad_fn=<MulBackward0>)
tr_loss tensor([503.4797]) 25.0]
ELBO:  tensor([-100.7076], grad_fn=<AddBackward0>)
batch_loss tensor([100.7076], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.7076], grad_fn=<MulBackward0>)
tr_loss tensor([604.1873]) 31.25]
ELBO:  tensor([-100.8217], grad_fn=<AddBackward0>)
batch_loss tensor([100.8217], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.8217], grad_fn=<MulBackward0>)
tr_loss tensor([705.0090]) 37.5]
ELBO:  tensor([-100.5140], grad_fn=<AddBackward0>)
batch_loss tensor([100.5140], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.5140], grad_fn=<MulBackward0>)
tr_loss tensor([805.5231]) 43.75]
ELBO:  tensor([-100.7856], grad_fn=<AddBackward0>)
batch_loss tensor([100.7856], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.7856], grad_fn=<MulBackward0>)
tr_loss tensor([906.3087]) 50.0]
ELBO:  tensor([-101.1051], grad_fn=<AddBackward0>)
batch_loss tensor([101.1051], grad_fn=<MulBackward0>)
batch loss after backward tensor([101.1051], grad_fn=<MulBackward0>)
tr_loss tensor([1007.4139])56.25]
ELBO:  tensor([-100.4800], grad_fn=<AddBackward0>)
batch_loss tensor([100.4800], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.4800], grad_fn=<MulBackward0>)
tr_loss tensor([1107.8938])62.5]
ELBO:  tensor([-100.7275], grad_fn=<AddBackward0>)
batch_loss tensor([100.7275], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.7275], grad_fn=<MulBackward0>)
tr_loss tensor([1208.6213])68.75]
ELBO:  tensor([-100.5944], grad_fn=<AddBackward0>)
batch_loss tensor([100.5944], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.5944], grad_fn=<MulBackward0>)
tr_loss tensor([1309.2157])75.0]
ELBO:  tensor([-100.2201], grad_fn=<AddBackward0>)
batch_loss tensor([100.2201], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.2201], grad_fn=<MulBackward0>)
tr_loss tensor([1409.4358])81.25]
ELBO:  tensor([-100.4112], grad_fn=<AddBackward0>)
batch_loss tensor([100.4112], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.4112], grad_fn=<MulBackward0>)
tr_loss tensor([1509.8470])87.5]
ELBO:  tensor([-100.8232], grad_fn=<AddBackward0>)
batch_loss tensor([100.8232], grad_fn=<MulBackward0>)
batch loss after backward tensor([100.8232], grad_fn=<MulBackward0>)
tr_loss tensor([1610.6703])93.75]
epoch loss:
Traceback (most recent call last):
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 125, in <module>
    main()
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 99, in main
    model.fit(train_data=(X_train, y_train), val_data=(X_val, y_val),
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/DirVRNN.py", line 551, in fit
    "Train {} ({:.0f}%):  [loss {:.2f} - loglik {:.2f} - kl {:.2f} - outl {:.2f}]".format(
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/site-packages/torch/_tensor.py", line 873, in __format__
    return object.__format__(self, format_spec)
epoch loss:  tensor([100.6669])
epoch loglik:  tensor([-97.6007])
epoch kl:  tensor([4.4578])
epoch outl:  tensor([1.3916])
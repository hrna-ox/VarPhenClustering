Loading and Processing Data...
Data MIMIC successfully loaded for features ['DBP', 'ESI', 'HR', 'RR', 'SBP', 'SPO2', 'TEMP', 'age', 'gender'] and outcomes ['Death', 'Discharge', 'ICU', 'Ward'].
(X, y) shape: (8328, 10, 9), (8328, 4)
Outcome Distribution: Death          26
Discharge    2860
ICU          1321
Ward         4121
dtype: int64
Loading and Training Model for fold 1...
 Logging experiments in exps/DirVRNN/Run_16_2023-08-02_17-12-44/fold_1
ERROR: NaNs in estimated representations
ERROR: NaNs in estimated representations
> /home/ball4537/PycharmProjects/VarPhenClustering/src/models/DirVRNN.py(428)forward()
-> y_pred = self._predictor_pass(z=fut_z)
tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], grad_fn=<ReluBackward0>)
tensor([[nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan]], grad_fn=<DivBackward0>)
tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], grad_fn=<MmBackward0>)
1
*** NameError: name 'batch_id' is not defined
tensor(nan, grad_fn=<MeanBackward1>)
tensor([[0.0782, 0.0000, 0.6569, 0.4235, 0.7398, 0.8919, 0.9095, 0.3699, 1.0000],
        [0.0828, 0.5000, 0.4672, 0.3294, 0.5357, 0.9459, 0.9296, 0.6164, 1.0000],
        [0.0642, 0.5000, 0.4453, 0.4000, 0.4847, 0.8378, 0.9181, 0.3699, 1.0000],
        [0.0560, 0.5000, 0.3942, 0.3765, 0.4796, 0.9730, 0.9253, 0.3836, 1.0000],
        [0.0338, 0.5000, 0.4380, 0.3765, 0.4643, 0.8919, 0.9109, 0.1781, 0.0000],
        [0.0449, 0.0000, 0.5328, 0.5176, 0.4643, 1.0000, 0.9540, 0.5890, 0.0000],
        [0.0793, 0.5000, 0.6642, 0.4000, 0.5663, 1.0000, 0.9267, 0.1233, 1.0000],
        [0.0747, 0.5000, 0.2847, 0.3765, 0.5714, 0.9189, 0.9037, 0.4521, 1.0000],
        [0.0828, 0.0000, 0.4453, 0.4235, 0.7500, 0.8378, 0.9138, 0.5753, 1.0000],
        [0.0677, 0.0000, 0.3577, 0.4706, 0.6684, 0.9459, 0.9138, 0.7945, 1.0000],
        [0.0478, 0.0000, 0.4672, 0.3765, 0.8010, 0.8649, 0.9095, 0.9315, 0.0000],
        [0.0513, 0.5000, 0.3942, 0.3294, 0.4949, 1.0000, 0.9152, 0.2055, 1.0000],
        [0.0700, 0.0000, 0.4526, 0.4471, 0.6020, 0.9459, 0.9195, 0.7671, 1.0000],
        [0.0863, 0.5000, 0.4088, 0.3765, 0.7296, 0.9730, 0.9124, 0.5616, 1.0000],
        [0.0875, 0.5000, 0.6058, 0.4235, 0.6224, 0.9189, 0.9239, 0.4247, 1.0000],
        [0.0723, 0.0000, 0.5474, 0.5176, 0.7347, 0.9459, 0.9267, 0.9589, 0.0000],
        [0.0432, 0.5000, 0.4161, 0.4235, 0.4592, 1.0000, 0.9109, 0.0137, 0.0000],
        [0.0852, 0.5000, 0.3650, 0.4235, 0.7959, 0.8919, 0.9138, 0.9315, 0.0000],
        [0.0548, 0.0000, 0.4964, 0.3765, 0.5765, 0.9189, 0.9195, 0.1233, 1.0000],
        [0.0653, 0.0000, 0.5985, 0.4235, 0.5918, 0.9189, 0.9124, 0.6438, 1.0000],
        [0.0782, 1.0000, 0.4526, 0.4000, 0.6224, 0.9459, 0.9109, 0.4521, 1.0000],
        [0.0595, 0.0000, 0.3358, 0.3765, 0.5408, 0.8649, 0.9109, 1.0000, 0.0000],
        [0.0793, 0.0000, 0.2409, 0.3529, 0.7194, 1.0000, 0.9138, 0.6849, 1.0000],
        [0.0607, 0.0000, 0.2555, 0.4000, 0.6327, 0.9459, 0.9080, 0.8630, 1.0000],
        [0.0817, 0.5000, 0.5401, 0.4235, 0.6378, 0.9459, 0.9210, 0.5479, 0.0000],
        [0.0379, 0.0000, 0.5109, 0.6000, 0.5485, 0.9865, 0.9124, 0.8082, 1.0000],
        [0.0607, 0.5000, 0.4964, 0.3765, 0.5459, 0.9189, 0.9167, 0.8356, 1.0000],
        [0.0397, 0.0000, 0.1752, 0.3765, 0.5357, 0.8919, 0.9210, 0.7123, 0.0000],
        [0.0537, 0.5000, 0.2555, 0.4235, 0.5714, 1.0000, 0.9138, 0.5753, 1.0000],
        [0.0653, 0.5000, 0.3212, 0.3059, 0.5663, 0.9459, 0.9152, 0.6849, 1.0000],
        [0.0490, 0.0000, 0.5109, 0.3765, 0.3929, 1.0000, 0.9167, 0.7945, 1.0000],
        [0.0945, 0.0000, 0.3650, 0.3765, 0.6531, 1.0000, 0.9167, 0.5616, 1.0000]])
tensor([[nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan],
        [nan, nan, nan, nan, nan, nan, nan, nan, nan]],
       grad_fn=<SliceBackward0>)
tensor([[nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        ...,
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan],
        [nan, nan, nan,  ..., nan, nan, nan]], grad_fn=<MmBackward0>)
32
10
9
0
tensor([[[0.1095, 0.0000, 0.5690,  ..., 0.5668, 0.3699, 1.0000],
         [0.1092, 0.0000, 0.5918,  ..., 0.5589, 0.3699, 1.0000],
         [0.1092, 0.0000, 0.6788,  ..., 0.9325, 0.3699, 1.0000],
         ...,
         [0.2638, 0.0000, 0.6439,  ..., 0.9095, 0.3699, 1.0000],
         [0.0782, 0.0000, 0.6439,  ..., 0.9095, 0.3699, 1.0000],
         [0.0782, 0.0000, 0.6569,  ..., 0.9095, 0.3699, 1.0000]],
        [[0.0981, 0.5000, 0.3534,  ..., 0.5737, 0.6164, 1.0000],
         [0.1171, 0.5000, 0.3796,  ..., 0.5659, 0.6164, 1.0000],
         [0.1171, 0.5000, 0.4891,  ..., 0.9405, 0.6164, 1.0000],
         ...,
         [0.2795, 0.5000, 0.4470,  ..., 0.9296, 0.6164, 1.0000],
         [0.0828, 0.5000, 0.4470,  ..., 0.9296, 0.6164, 1.0000],
         [0.0828, 0.5000, 0.4672,  ..., 0.9296, 0.6164, 1.0000]],
        [[0.0659, 0.5000, 0.3190,  ..., 0.5634, 0.3699, 1.0000],
         [0.0829, 0.5000, 0.2980,  ..., 0.5598, 0.3699, 1.0000],
         [0.0829, 0.5000, 0.4161,  ..., 0.9335, 0.3699, 1.0000],
         ...,
         [0.2165, 0.5000, 0.4242,  ..., 0.9181, 0.3699, 1.0000],
         [0.0642, 0.5000, 0.4242,  ..., 0.9181, 0.3699, 1.0000],
         [0.0642, 0.5000, 0.4453,  ..., 0.9181, 0.3699, 1.0000]],
        ...,
        [[0.0517, 0.5000, 0.0991,  ..., 0.5634, 0.6849, 1.0000],
         [0.0717, 0.5000, 0.1388,  ..., 0.5555, 0.6849, 1.0000],
         [0.0868, 0.5000, 0.3558,  ..., 0.9286, 0.6849, 1.0000],
         ...,
         [0.2205, 0.5000, 0.2955,  ..., 0.9152, 0.6849, 1.0000],
         [0.0653, 0.5000, 0.2955,  ..., 0.9152, 0.6849, 1.0000],
         [0.0653, 0.5000, 0.3212,  ..., 0.9152, 0.6849, 1.0000]],
        [[0.0565, 0.0000, 0.3621,  ..., 0.5532, 0.7945, 1.0000],
         [0.0730, 0.0000, 0.4041,  ..., 0.5520, 0.7945, 1.0000],
         [0.0770, 0.0000, 0.5036,  ..., 0.9246, 0.7945, 1.0000],
         ...,
         [0.1654, 0.0000, 0.4924,  ..., 0.9167, 0.7945, 1.0000],
         [0.0490, 0.0000, 0.4924,  ..., 0.9167, 0.7945, 1.0000],
         [0.0490, 0.0000, 0.5109,  ..., 0.9167, 0.7945, 1.0000]],
        [[0.0833, 0.0000, 0.2931,  ..., 0.5694, 0.5616, 1.0000],
         [0.1026, 0.0000, 0.3224,  ..., 0.5615, 0.5616, 1.0000],
         [0.1026, 0.0000, 0.4380,  ..., 0.9355, 0.5616, 1.0000],
         ...,
         [0.3189, 0.0000, 0.3409,  ..., 0.9167, 0.5616, 1.0000],
         [0.0945, 0.0000, 0.3409,  ..., 0.9167, 0.5616, 1.0000],
         [0.0945, 0.0000, 0.3650,  ..., 0.9167, 0.5616, 1.0000]]])

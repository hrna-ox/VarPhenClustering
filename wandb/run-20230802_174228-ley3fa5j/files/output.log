Loading and Processing Data...
Data MIMIC successfully loaded for features ['DBP', 'ESI', 'HR', 'RR', 'SBP', 'SPO2', 'TEMP', 'age', 'gender'] and outcomes ['Death', 'Discharge', 'ICU', 'Ward'].
(X, y) shape: (8328, 10, 9), (8328, 4)
Outcome Distribution: Death          26
Discharge    2860
ICU          1321
Ward         4121
dtype: int64
Loading and Training Model for fold 1...
 Logging experiments in exps/DirVRNN/Run_24_2023-08-02_17-42-33/fold_1
ELBO:  tensor([-99.1322], grad_fn=<AddBackward0>)
batch_loss tensor([99.1322], grad_fn=<MulBackward0>)
tr_loss tensor([99.1322]) 0.0]
ELBO:  tensor([-98.7875], grad_fn=<AddBackward0>)
batch_loss tensor([98.7875], grad_fn=<MulBackward0>)
tr_loss tensor([197.9197])6.25]
ELBO:  tensor([-99.2033], grad_fn=<AddBackward0>)
batch_loss tensor([99.2033], grad_fn=<MulBackward0>)
tr_loss tensor([297.1230])12.5]
ELBO:  tensor([-99.2406], grad_fn=<AddBackward0>)
batch_loss tensor([99.2406], grad_fn=<MulBackward0>)
tr_loss tensor([396.3636])18.75]
ELBO:  tensor([-99.2053], grad_fn=<AddBackward0>)
batch_loss tensor([99.2053], grad_fn=<MulBackward0>)
tr_loss tensor([495.5689])25.0]
ELBO:  tensor([-99.4258], grad_fn=<AddBackward0>)
batch_loss tensor([99.4258], grad_fn=<MulBackward0>)
tr_loss tensor([594.9947])31.25]
ELBO:  tensor([-98.9574], grad_fn=<AddBackward0>)
batch_loss tensor([98.9574], grad_fn=<MulBackward0>)
tr_loss tensor([693.9521])37.5]
ELBO:  tensor([-98.8530], grad_fn=<AddBackward0>)
batch_loss tensor([98.8530], grad_fn=<MulBackward0>)
tr_loss tensor([792.8051])43.75]
ELBO:  tensor([-98.6303], grad_fn=<AddBackward0>)
batch_loss tensor([98.6303], grad_fn=<MulBackward0>)
tr_loss tensor([891.4354])50.0]
ELBO:  tensor([-99.0414], grad_fn=<AddBackward0>)
batch_loss tensor([99.0414], grad_fn=<MulBackward0>)
tr_loss tensor([990.4769])56.25]
ELBO:  tensor([-98.8775], grad_fn=<AddBackward0>)
batch_loss tensor([98.8775], grad_fn=<MulBackward0>)
tr_loss tensor([1089.3544])2.5]
ELBO:  tensor([-99.4528], grad_fn=<AddBackward0>)
batch_loss tensor([99.4528], grad_fn=<MulBackward0>)
tr_loss tensor([1188.8071])8.75]
ELBO:  tensor([-98.9744], grad_fn=<AddBackward0>)
batch_loss tensor([98.9744], grad_fn=<MulBackward0>)
tr_loss tensor([1287.7815])5.0]
ELBO:  tensor([-99.2782], grad_fn=<AddBackward0>)
batch_loss tensor([99.2782], grad_fn=<MulBackward0>)
tr_loss tensor([1387.0597])1.25]
ELBO:  tensor([-99.2539], grad_fn=<AddBackward0>)
batch_loss tensor([99.2539], grad_fn=<MulBackward0>)
tr_loss tensor([1486.3136])7.5]
ELBO:  tensor([-99.3697], grad_fn=<AddBackward0>)
batch_loss tensor([99.3697], grad_fn=<MulBackward0>)
tr_loss tensor([1585.6832])3.75]
epoch loss:  tensor([99.1052])
epoch loglik:  tensor([-102.1456])
epoch kl:  tensor([-1.5092])
epoch outl:  tensor([1.5312])
Traceback (most recent call last):
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 125, in <module>
    main()
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/dirvrnn_run.py", line 99, in main
    model.fit(train_data=(X_train, y_train), val_data=(X_val, y_val),
  File "/home/ball4537/PycharmProjects/VarPhenClustering/src/models/DirVRNN.py", line 550, in fit
    "Train {} ({:.0f}%):  [loss {:.2f} - loglik {:.2f} - kl {:.2f} - outl {:.2f}]".format(
  File "/home/ball4537/anaconda3/envs/dirvrnn-env/lib/python3.10/site-packages/torch/_tensor.py", line 873, in __format__
    return object.__format__(self, format_spec)
TypeError: unsupported format string passed to Tensor.__format__